.app.app-container
    menu
    section.app.app-content(ng-if='$ctrl.validatorRequests'): .card
        .card-header: .flex-row
            .flex.flex-grow: .card-title
                span(i18n="validation_requests.header.title")
                span(ng-bind="$ctrl.validatorRequests.meta.total").span-count

            .flex: .block.block-inline-filters
                .button.button-text(ng-if="$ctrl.filters.show" ng-click="$ctrl.filters.reset()")
                    em.mdi.mdi-close.icon-start
                    span(i18n="validation_requests.buttons.clear_filter")

                .form(ng-if="!$ctrl.filters.show"): .form-group: input(
                    ng-model="$ctrl.filters.values.q"
                    placeholder="{{ 'validation_requests.labels.search' | i18n }}").form-control

                .form: .inline-filters-dropdown.pull-right(click-outside="$ctrl.hideFilters()")
                    .inline-filters-dropdown-content(ng-show="$ctrl.filters.show")
                        .arrow-box.bg-dim: .arrow
                        .form
                            .form-group
                                form-label-toggle(label="{{ 'validation_requests.labels.search' | i18n }}" is-active)
                                input(
                                    ng-model="$ctrl.filters.values.q"
                                    placeholder="{{ 'validation_requests.labels.search' | i18n }}").form-control

                            .form-group(ng-click="$event.stopPropagation()")
                                form-label-toggle(label="{{ 'validation_requests.labels.status' | i18n }}")
                                .form-offset: select-control(
                                    prop="key"
                                    search="false"
                                    ng-model="$ctrl.filters.values.state"
                                    options="$ctrl.states").form-control

                            .form-group(ng-click="$event.stopPropagation()")
                                form-label-toggle(label="{{ 'validation_requests.labels.assigned_to' | i18n }}")
                                .form-offset: select-control(
                                    prop="id"
                                    as="email"
                                    search="false"
                                    ng-model="$ctrl.filters.values.employee_id"
                                    options="$ctrl.employees.data").form-control

                            .form-group
                                form-label-toggle(label="{{ 'validation_requests.labels.from' | i18n }}")
                                datepicker(
                                    date-format="dd-MM-yyyy"
                                    datepicker-mobile=""
                                    date-week-start-day="1").form-control
                                    input(ng-model="$ctrl.filters.values.from" type="text" placeholder="dd-MM-yyyy").form-control

                            .form-group
                                form-label-toggle(label="{{ 'validation_requests.labels.to' | i18n }}")
                                datepicker(
                                    date-format="dd-MM-yyyy"
                                    datepicker-mobile=""
                                    date-week-start-day="1").form-control
                                    input(ng-model="$ctrl.filters.values.to" type="text" placeholder="dd-MM-yyyy").form-control

                            .form-actions
                                button.button.button-primary.button-wide(
                                    ng-click="$ctrl.exportRequests()"
                                    ng-disabled="$ctrl.validatorRequests.meta.total == 0")
                                    em.mdi.mdi-download.icon-start
                                    span.ng-scope(translate="components.dropdown.export" translate-values="{ total: $ctrl.validatorRequests.meta.total }")

                    .button.button-default.button-icon(ng-click="$ctrl.filters.show = !$ctrl.filters.show"): em.mdi.mdi-filter-outline

        //- Fund requests
        .card-section(ng-if="$ctrl.validatorRequests.meta.total > 0")
            .card-block.card-block-table
                .table-wrapper
                    table.table
                        tr
                            th(translate="validation_requests.labels.assigned_to")
                            th(translate="validation_requests.labels.created_date").nowrap
                            th(translate="validation_requests.labels.fund")
                            th(translate="validation_requests.labels.bsn")
                            th(translate="validation_requests.labels.email")
                            th(translate="validation_requests.labels.status")
                            th(translate="validation_requests.labels.actions").nowrap.text-right

                        tr(ng-repeat="validatorRequest in $ctrl.validatorRequests.data"
                            ui-sref="fund-requests-show(validatorRequest.ui_sref)")
                            td(ng-bind="validatorRequest.id")
                            td(ng-bind="validatorRequest.created_at_locale")
                            td(ng-bind="validatorRequest.fund.name")
                            td(ng-bind="validatorRequest.bsn || 'Geen'" ng-class="validatorRequest.bsn ? '' : 'text-muted'")
                            td(ng-bind="validatorRequest.email || 'Geen'" ng-class="validatorRequest.email ? '' : 'text-muted'")

                            td: .label(ng-class="$ctrl.stateClasses[validatorRequest.state]" ng-bind="validatorRequest.state_locale")

                            td.td-narrow.text-right: a(ui-sref="fund-requests-show(validatorRequest.ui_sref)").button.button-sm.button-primary.pull-right
                                em.mdi.mdi-eye-outline.icon-start
                                translate(translate="validation_requests.buttons.view")

        //- Fund requests pagination
        .card-section(ng-if="$ctrl.validatorRequests" ng-show="$ctrl.validatorRequests.meta.last_page > 1")
            paginator(meta="$ctrl.validatorRequests.meta" filters="$ctrl.filters.values" on-page-change="$ctrl.onPageChange(query)")

        //- Empty fund requests block
        .card-section(ng-if="$ctrl.validatorRequests.meta.total == 0"): .block.block-empty.text-center
            .empty-title(i18n="validation_requests.labels.empty_table")