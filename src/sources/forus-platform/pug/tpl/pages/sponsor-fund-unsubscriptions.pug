.app.app-container
    menu
    section.app.app-content
        a.button.button-text(ui-sref="sponsor-provider-organizations({ organization_id: $ctrl.organization.id })")
            em.mdi.mdi-arrow-left.icon-start
            | Back to previous page

        //- Unsubscriptions list
        .card
            .card-header: .flex
                //- Title
                .flex.flex-grow: .card-title
                    span(translate="Unsubscription requests")
                    | &nbsp;
                    span(ng-bind="$ctrl.fundUnsubscribes.meta.total").span-count
                
                .block.block-label-tabs.nowrap.pull-right: .label-tab-set
                    .label-tab.label-tab-sm(
                        ng-class="{'active' : $ctrl.shownType == 'all'}" 
                        ng-click="$ctrl.filterByType('all')")
                        | Alle
                    .label-tab.label-tab-sm(
                        ng-class="{'active' : $ctrl.shownType == 'pending'}" 
                        ng-click="$ctrl.filterByType('pending')")
                        | In afwachting
                    .label-tab.label-tab-sm(
                        ng-class="{'active' : $ctrl.shownType == 'archive'}" 
                        ng-click="$ctrl.filterByType('archive')")
                        | Gearchiveerd

            .card-section(ng-if="$ctrl.fundUnsubscribes.meta.total > 0")
                .card-block.card-block-table.card-block-table-fund.form
                    .table-wrapper
                        table.table
                            tr
                                th(translate="fund_unsubscriptions.labels.provider")
                                th(translate="fund_unsubscriptions.labels.fund")
                                th(translate="fund_unsubscriptions.labels.created_at")
                                th(translate="fund_unsubscriptions.labels.note")
                                th(translate="fund_unsubscriptions.labels.status")
                                th(translate="fund_unsubscriptions.labels.unsubscription_date").nowrap.text-right

                            tr(
                                ng-repeat="unsubscription in $ctrl.fundUnsubscribes.data"
                                ui-sref="sponsor-provider-organization({ organization_id: $ctrl.organization.id, provider_organization_id: unsubscription.fund_provider.organization.id })")
                                td.nowrap
                                    .fund-img: img(ng-src="{{ unsubscription.fund_provider.organization.logo.sizes.thumbnail || './assets/img/placeholders/organization-thumbnail.png' }}" alt="")
                                    .fund-title(ng-bind="unsubscription.fund_provider.organization.name")

                                td(
                                    ng-bind="unsubscription.fund_provider.fund.name | str_limit:25"
                                    title="{{ unsubscription.fund_provider.fund.name }}")

                                td.nowrap
                                    strong(ng-bind="unsubscription.created_at_locale").text-strong.text-md.text-muted-dark

                                td(
                                    ng-bind="unsubscription.note | str_limit:25"
                                    title="{{ unsubscription.note }}")

                                td
                                    .tag.tag-sm(
                                        ng-class="{'tag-success': unsubscription.state == 'approved', 'tag-warning': unsubscription.state == 'pending' && !unsubscription.is_expired, 'tag-danger': unsubscription.is_expired}" 
                                        ng-bind="unsubscription.state_locale")

                                td.nowrap.text-right
                                    em.mdi.mdi-alert(ng-if="unsubscription.is_expired")
                                    strong(ng-bind="unsubscription.unsubscribe_date_locale").text-strong.text-md.text-muted-dark

            .card(ng-if="$ctrl.fundUnsubscribes.meta.total > 0" ng-show="$ctrl.fundUnsubscribes.meta.last_page > 1"): .card-section
                paginator(meta="$ctrl.fundUnsubscribes.meta" filters="$dir.filters.values" count-buttons="5" on-page-change="$dir.onPageChange(query)")

            //- Not found
            .card-section(ng-if="$ctrl.fundUnsubscribes.meta.total == 0"): .block.block-empty.text-center
                .empty-title(ng-bind="$ctrl.emptyBlockText")
